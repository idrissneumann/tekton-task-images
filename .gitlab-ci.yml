stages:
  - mirror
  - publish

github-mirror:
  stage: mirror
  script:
    - setsid ./ci/github-mirror.sh
  only:
    - /^(master.*)$/
  tags:
    - tekton-utils

slack-sender:
  stage: publish
  script:
    - setsid ./ci/docker-deliver.sh "slack-sender" "1.0"
  only:
    refs:
      - /^(master.*)$/
    changes:
      - slack-sender/*
  tags:
    - tekton-utils

github-search-pr:
  stage: publish
  script:
    - setsid ./ci/docker-deliver.sh "github-search-pr" "1.0"
  only:
    refs:
      - /^(master.*)$/
    changes:
      - github-search-pr/*
  tags:
    - tekton-utils

github-set-status:
  stage: publish
  script:
    - setsid ./ci/docker-deliver.sh "github-set-status" "1.0"
  only:
    refs:
      - /^(master.*)$/
    changes:
      - github-set-status/*
  tags:
    - tekton-utils

git-fetch-sources:
  stage: publish
  script:
    - setsid ./ci/docker-deliver.sh "git-fetch-sources" "1.0"
  only:
    refs:
      - /^(master.*)$/
    changes:
      - git-fetch-sources/*
  tags:
    - tekton-utils
